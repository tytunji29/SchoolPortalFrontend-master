import{a as oe,b as se,c as ae}from"./chunk-5GULS5GK.js";import{a as ce}from"./chunk-KEQMXZG3.js";import"./chunk-GOXB5OSV.js";import{a as $}from"./chunk-4BHWRWDA.js";import{a as F}from"./chunk-ZP7S6SWW.js";import{b as K,c as Y,d as z,g as J,j as Q,k as X,q as Z,r as ee,s as te,t as ie,v as ne,w as re}from"./chunk-EAGDHIOY.js";import{aa as N,ba as V,bb as W,cb as A,d as k,qb as q,ra as O,sa as R,sb as j,tb as U,ub as G,va as P,vb as H,w as I}from"./chunk-ZE63MCPL.js";import{Kb as t,Lb as n,Qb as B,Vb as p,Xb as S,db as l,eb as T,hc as a,ia as w,ic as g,mc as f,nc as h,oc as _,qc as L,sc as D,ta as y,tc as x,ua as v,vc as E,xb as b,zb as C}from"./chunk-DRLFSV2D.js";import{a as M,f as le}from"./chunk-TMEVGU2Q.js";var m=le(ce());var me=c=>({itemsPerPage:4,currentPage:c});function de(c,d){if(c&1){let u=B();t(0,"tr")(1,"th",21),a(2),n(),t(3,"td"),a(4),n(),t(5,"td")(6,"button",22),p("click",function(){let i=y(u).$implicit,e=S();return v(e.viewCountry(i))}),t(7,"i",23),a(8,"view my students"),n()(),t(9,"button",24),p("click",function(){let i=y(u).$implicit,e=S();return v(e.editCountry(i))}),t(10,"i",25),a(11,"edit"),n()(),t(12,"button",26),p("click",function(){let i=y(u).$implicit,e=S();return v(e.deleteCountry(i))}),t(13,"i",27),a(14,"delete"),n()()()()}if(c&2){let u=d.$implicit,r=d.index;l(2),g(r+1),l(2),g(u.name)}}function ue(c,d){if(c&1&&(t(0,"option",28),a(1),n()),c&2){let u=d.$implicit;C("value",u.name),l(),g(u.name)}}function pe(c,d){if(c&1&&(t(0,"option",28),a(1),n()),c&2){let u=d.$implicit;C("value",u.name),l(),g(u.name)}}var Ce="/teachers/students",Re=(()=>{let d=class d{constructor(r,i){this.router=r,this.apiService=i,this.conList=[],this.searchText="",this.p=1,this.isModalVisible=!1,this.isEditMode=!1,this.classLevels=[],this.classTeachers=[],this.currentCountry={name:"",classLevel:"",classTeacher:""}}refreshData(){let r=localStorage.getItem("userId");this.apiService.get(`Classes/GetAllByTeacherId/${r}`).subscribe({next:i=>{i.status==="success"?this.conList=i.data:m.default.fire({title:"Error",text:`${i.message}`,icon:"error",confirmButtonText:"Retry"})},error:i=>{m.default.fire({title:"Error",text:`${i.error.message}`,icon:"error",confirmButtonText:"Retry"})}})}ngOnInit(){this.refreshData()}saveCountry(){console.log("Save country:",this.currentCountry),this.isEditMode=!1;let r=`${this.currentCountry.name} ${this.currentCountry.classLevel}`,i=`${this.currentCountry.classTeacher}`,e={name:r,teacher:i};this.apiService.post("Classes/Add",e).subscribe({next:s=>{console.log("Classes added successful",s),s.status==="success"?m.default.fire({title:"Success!",text:`${s.message}`,icon:"success",confirmButtonText:"OK"}).then(()=>{this.closeModal(),this.ngOnInit()}):m.default.fire({title:"Error",text:`${s.message}`,icon:"error",confirmButtonText:"Retry"})},error:s=>{m.default.fire({title:"Error",text:`${s.error.message}`,icon:"error",confirmButtonText:"Retry"})}})}updateCountry(){let r={name:`${this.currentCountry.name} ${this.currentCountry.classLevel}`,teacher:`${this.currentCountry.classTeacher}`};this.apiService.put(`Classes/UpdateById/${this.currentCountry.id}`,r).subscribe({next:i=>{if(i.status==="success"){let e=this.conList.findIndex(s=>s.id===this.currentCountry._id);e!==-1&&(this.conList[e]=M({},this.currentCountry)),m.default.fire({title:"Updated!",text:`${i.message}`,icon:"success",confirmButtonText:"OK"}).then(()=>{this.closeModal(),this.ngOnInit()})}else m.default.fire({title:"Error",text:`${i.message}`,icon:"error",confirmButtonText:"Retry"})},error:i=>{m.default.fire({title:"Error",text:`${i.error.message||"An unexpected error occurred"}`,icon:"error",confirmButtonText:"Retry"})}})}viewCountry(r){this.router.navigate([Ce])}editCountry(r){console.log("Edit country:",r),this.currentCountry=M({},r),this.isEditMode=!0,this.openModal()}deleteCountry(r){m.default.fire({title:"Are you sure?",text:`Do you want to delete ${r.name}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then(i=>{i.isConfirmed?this.apiService.delete(`Classes/DeleteById/${r.id}`).subscribe({next:()=>{this.conList=this.conList.filter(e=>e.id!==r.id),m.default.fire("Deleted!",`${r.name} has been deleted.`,"success"),this.ngOnInit()},error:e=>{m.default.fire({title:"Error",text:`${e.error.message}`,icon:"error",confirmButtonText:"Retry"})}}):i.dismiss===m.default.DismissReason.cancel&&m.default.fire("Cancelled",`${r.name} is safe.`,"error")})}openModal(){console.log("Opening modal"),this.isModalVisible=!0}closeModal(){this.isModalVisible=!1}};d.\u0275fac=function(i){return new(i||d)(T(I),T(F))},d.\u0275cmp=w({type:d,selectors:[["app-classes"]],standalone:!0,features:[L],decls:48,vars:18,consts:[["xs","12"],[1,"mb-4"],[1,"d-flex","justify-content-between","align-items-center"],["type","text","placeholder","Search class",1,"form-control","mb-3",3,"ngModelChange","ngModel"],["cTable","",1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],[3,"pageChange"],["backdrop","static",3,"visibleChange","visible"],["cModalTitle",""],["cButtonClose","",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","countryName"],["type","text","id","countryName","placeholder","Name","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","classLevel"],["id","classLevel","name","classLevel","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["id","classTeacher","name","classTeacher","required","",1,"form-control",3,"ngModelChange","ngModel"],["cButton","","color","secondary",3,"click"],["cButton","","color","primary",3,"click"],["scope","row"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-eyes"],[1,"btn","btn-sm","btn-warning",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fa","fa-times"],[3,"value"]],template:function(i,e){i&1&&(t(0,"c-row")(1,"c-col",0)(2,"c-card",1)(3,"c-card-header",2)(4,"strong"),a(5,"Classes List"),n()(),t(6,"c-card-body")(7,"input",3),_("ngModelChange",function(o){return h(e.searchText,o)||(e.searchText=o),o}),n(),t(8,"table",4)(9,"thead")(10,"tr")(11,"th",5),a(12,"SN"),n(),t(13,"th",5),a(14,"Class"),n(),t(15,"th",5),a(16,"Actions"),n()()(),t(17,"tbody"),b(18,de,15,2,"tr",6),x(19,"search"),x(20,"paginate"),n()(),t(21,"pagination-controls",7),p("pageChange",function(o){return e.p=o}),n()()()()(),t(22,"c-modal",8),p("visibleChange",function(o){return e.isModalVisible=o}),t(23,"c-modal-header")(24,"h5",9),a(25),n(),t(26,"button",10),p("click",function(){return e.closeModal()}),n()(),t(27,"c-modal-body")(28,"form",11),p("ngSubmit",function(){return e.isEditMode?e.updateCountry():e.saveCountry()}),t(29,"div",12)(30,"label",13),a(31,"Class Name"),n(),t(32,"input",14),_("ngModelChange",function(o){return h(e.currentCountry.name,o)||(e.currentCountry.name=o),o}),n()(),t(33,"div",12)(34,"label",15),a(35,"Class Level"),n(),t(36,"select",16),_("ngModelChange",function(o){return h(e.currentCountry.classLevel,o)||(e.currentCountry.classLevel=o),o}),b(37,ue,2,2,"option",17),n()(),t(38,"div",12)(39,"label",15),a(40,"Class Facilitator"),n(),t(41,"select",18),_("ngModelChange",function(o){return h(e.currentCountry.classTeacher,o)||(e.currentCountry.classTeacher=o),o}),b(42,pe,2,2,"option",17),n()()()(),t(43,"c-modal-footer")(44,"button",19),p("click",function(){return e.closeModal()}),a(45,"Close"),n(),t(46,"button",20),p("click",function(){return e.isEditMode?e.updateCountry():e.saveCountry()}),a(47),n()()()),i&2&&(l(7),f("ngModel",e.searchText),l(11),C("ngForOf",E(20,13,E(19,10,e.conList,e.searchText),D(16,me,e.p))),l(4),C("visible",e.isModalVisible),l(3),g(e.isEditMode?"Edit Class":"Add Class"),l(7),f("ngModel",e.currentCountry.name),l(4),f("ngModel",e.currentCountry.classLevel),l(),C("ngForOf",e.classLevels),l(4),f("ngModel",e.currentCountry.classTeacher),l(),C("ngForOf",e.classTeachers),l(5),g(e.isEditMode?"Update":"Save"))},dependencies:[A,W,O,P,R,re,X,ee,te,K,Z,Y,z,ie,ne,Q,J,N,k,ae,se,oe,$,H,U,G,q,j,V]});let c=d;return c})();export{Re as ClassesComponent};
