import{a as re,b as oe,c as se}from"./chunk-5GULS5GK.js";import{a as le}from"./chunk-KEQMXZG3.js";import"./chunk-GOXB5OSV.js";import{a as N}from"./chunk-4BHWRWDA.js";import{a as k}from"./chunk-ZP7S6SWW.js";import{b as j,c as K,d as Y,g as z,j as J,k as Q,q as X,r as Z,s as ee,t as te,v as ne,w as ie}from"./chunk-EAGDHIOY.js";import{aa as $,ba as F,bb as W,cb as P,d as A,qb as R,ra as I,sa as V,sb as q,tb as G,ub as H,va as O,vb as U}from"./chunk-ZE63MCPL.js";import{Kb as n,Lb as i,Qb as L,Vb as p,Xb as S,db as a,eb as w,hc as o,ia as E,ic as C,mc as g,nc as f,oc as _,qc as B,sc as D,ta as v,tc as M,ua as T,vc as x,xb as y,zb as h}from"./chunk-DRLFSV2D.js";import{a as b,f as ae}from"./chunk-TMEVGU2Q.js";var u=ae(le());var ce=l=>({itemsPerPage:4,currentPage:l});function me(l,m){if(l&1){let c=L();n(0,"tr")(1,"th",23),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td")(10,"button",24),p("click",function(){let s=v(c).$implicit,e=S();return T(e.viewCountry(s))}),n(11,"i",25),o(12,"view"),i()(),n(13,"button",26),p("click",function(){let s=v(c).$implicit,e=S();return T(e.editCountry(s))}),n(14,"i",27),o(15,"edit"),i()(),n(16,"button",28),p("click",function(){let s=v(c).$implicit,e=S();return T(e.deleteCountry(s))}),n(17,"i",29),o(18,"delete"),i()()()()}if(l&2){let c=m.$implicit,t=m.index;a(2),C(t+1),a(2),C(c.name),a(2),C(c.teacher),a(2),C(c.assistantTeacher)}}function de(l,m){if(l&1&&(n(0,"option",30),o(1),i()),l&2){let c=m.$implicit;h("value",c.name),a(),C(c.name)}}function ue(l,m){if(l&1&&(n(0,"option",30),o(1),i()),l&2){let c=m.$implicit;h("value",c.name),a(),C(c.name)}}function pe(l,m){if(l&1&&(n(0,"option",30),o(1),i()),l&2){let c=m.$implicit;h("value",c.name),a(),C(c.name)}}var Ie=(()=>{let m=class m{constructor(t){this.apiService=t,this.conList=[],this.searchText="",this.p=1,this.isModalVisible=!1,this.isEditMode=!1,this.classLevels=[],this.classTeachers=[],this.currentCountry={name:"",classLevel:"",classTeacher:"",classAssistTeacher:""}}refreshData(){this.apiService.get("Classes/GetAll").subscribe({next:t=>{t.status==="success"?this.conList=t.data:u.default.fire({title:"Error",text:`${t.message}`,icon:"error",confirmButtonText:"Retry"})},error:t=>{u.default.fire({title:"Error",text:`${t.error.message}`,icon:"error",confirmButtonText:"Retry"})}})}getClassLevels(){this.apiService.get("ClassLevel/GetAll").subscribe({next:t=>{console.log(t.data),this.classLevels=t.data},error:t=>{console.error("Error fetching class levels",t)}})}getClassTeachers(){this.apiService.get("Staff/GetAllTeacherAndAssist").subscribe({next:t=>{this.classTeachers=t.data},error:t=>{console.error("Error fetching class levels",t)}})}ngOnInit(){this.refreshData(),this.getClassLevels(),this.getClassTeachers()}saveCountry(){console.log("Save country:",this.currentCountry),this.isEditMode=!1;let t=`${this.currentCountry.name} ${this.currentCountry.classLevel}`,s=`${this.currentCountry.classTeacher}`,e=`${this.currentCountry.classAssistTeacher}`,d={name:t,teacher:s,assistantTeacher:e};this.apiService.post("Classes/Add",d).subscribe({next:r=>{console.log("Classes added successful",r),r.status==="success"?u.default.fire({title:"Success!",text:`${r.message}`,icon:"success",confirmButtonText:"OK"}).then(()=>{this.closeModal(),this.ngOnInit()}):u.default.fire({title:"Error",text:`${r.message}`,icon:"error",confirmButtonText:"Retry"})},error:r=>{u.default.fire({title:"Error",text:`${r.error.message}`,icon:"error",confirmButtonText:"Retry"})}})}updateCountry(){let t={name:`${this.currentCountry.name} ${this.currentCountry.classLevel}`,teacher:`${this.currentCountry.classTeacher}`};this.apiService.put(`Classes/UpdateById/${this.currentCountry.id}`,t).subscribe({next:s=>{if(s.status==="success"){let e=this.conList.findIndex(d=>d.id===this.currentCountry._id);e!==-1&&(this.conList[e]=b({},this.currentCountry)),u.default.fire({title:"Updated!",text:`${s.message}`,icon:"success",confirmButtonText:"OK"}).then(()=>{this.closeModal(),this.ngOnInit()})}else u.default.fire({title:"Error",text:`${s.message}`,icon:"error",confirmButtonText:"Retry"})},error:s=>{u.default.fire({title:"Error",text:`${s.error.message||"An unexpected error occurred"}`,icon:"error",confirmButtonText:"Retry"})}})}viewCountry(t){let e=new Date(t.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"});u.default.fire({title:"Country Details",html:`<strong>Country:</strong> ${t.name}
      <br/>
             <strong>CreatedAt:</strong> ${e} `,icon:"info",confirmButtonText:"Close"})}editCountry(t){console.log("Edit country:",t),this.currentCountry=b({},t),this.isEditMode=!0,this.openModal()}deleteCountry(t){u.default.fire({title:"Are you sure?",text:`Do you want to delete ${t.name}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then(s=>{s.isConfirmed?this.apiService.delete(`Classes/DeleteById/${t.id}`).subscribe({next:()=>{this.conList=this.conList.filter(e=>e.id!==t.id),u.default.fire("Deleted!",`${t.name} has been deleted.`,"success"),this.ngOnInit()},error:e=>{u.default.fire({title:"Error",text:`${e.error.message}`,icon:"error",confirmButtonText:"Retry"})}}):s.dismiss===u.default.DismissReason.cancel&&u.default.fire("Cancelled",`${t.name} is safe.`,"error")})}openModal(){console.log("Opening modal"),this.isModalVisible=!0}closeModal(){this.isModalVisible=!1}};m.\u0275fac=function(s){return new(s||m)(w(k))},m.\u0275cmp=E({type:m,selectors:[["app-class"]],standalone:!0,features:[B],decls:59,vars:20,consts:[["xs","12"],[1,"mb-4"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","btn-primary","ml-auto",3,"click"],["type","text","placeholder","Search class",1,"form-control","mb-3",3,"ngModelChange","ngModel"],["cTable","",1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],[3,"pageChange"],["backdrop","static",3,"visibleChange","visible"],["cModalTitle",""],["cButtonClose","",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","countryName"],["type","text","id","countryName","placeholder","Name","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","classLevel"],["id","classLevel","name","classLevel","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["id","classTeacher","name","classTeacher","required","",1,"form-control",3,"ngModelChange","ngModel"],["id","classTeacher","name","classAsstTeacher","required","",1,"form-control",3,"ngModelChange","ngModel"],["cButton","","color","secondary",3,"click"],["cButton","","color","primary",3,"click"],["scope","row"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-eyes"],[1,"btn","btn-sm","btn-warning",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fa","fa-times"],[3,"value"]],template:function(s,e){s&1&&(n(0,"c-row")(1,"c-col",0)(2,"c-card",1)(3,"c-card-header",2)(4,"strong"),o(5,"Classes List"),i(),n(6,"button",3),p("click",function(){return e.openModal()}),o(7,"Add"),i()(),n(8,"c-card-body")(9,"input",4),_("ngModelChange",function(r){return f(e.searchText,r)||(e.searchText=r),r}),i(),n(10,"table",5)(11,"thead")(12,"tr")(13,"th",6),o(14,"SN"),i(),n(15,"th",6),o(16,"Class"),i(),n(17,"th",6),o(18,"Teacher Name"),i(),n(19,"th",6),o(20,"Assistant Teacher Name"),i(),n(21,"th",6),o(22,"Actions"),i()()(),n(23,"tbody"),y(24,me,19,4,"tr",7),M(25,"search"),M(26,"paginate"),i()(),n(27,"pagination-controls",8),p("pageChange",function(r){return e.p=r}),i()()()()(),n(28,"c-modal",9),p("visibleChange",function(r){return e.isModalVisible=r}),n(29,"c-modal-header")(30,"h5",10),o(31),i(),n(32,"button",11),p("click",function(){return e.closeModal()}),i()(),n(33,"c-modal-body")(34,"form",12),p("ngSubmit",function(){return e.isEditMode?e.updateCountry():e.saveCountry()}),n(35,"div",13)(36,"label",14),o(37,"Class Name"),i(),n(38,"input",15),_("ngModelChange",function(r){return f(e.currentCountry.name,r)||(e.currentCountry.name=r),r}),i()(),n(39,"div",13)(40,"label",16),o(41,"Class Level"),i(),n(42,"select",17),_("ngModelChange",function(r){return f(e.currentCountry.classLevel,r)||(e.currentCountry.classLevel=r),r}),y(43,de,2,2,"option",18),i()(),n(44,"div",13)(45,"label",16),o(46,"Class Head Teacher"),i(),n(47,"select",19),_("ngModelChange",function(r){return f(e.currentCountry.classTeacher,r)||(e.currentCountry.classTeacher=r),r}),y(48,ue,2,2,"option",18),i()(),n(49,"div",13)(50,"label",16),o(51,"Class Assist Teacher"),i(),n(52,"select",20),_("ngModelChange",function(r){return f(e.currentCountry.classAssistTeacher,r)||(e.currentCountry.classAssistTeacher=r),r}),y(53,pe,2,2,"option",18),i()()()(),n(54,"c-modal-footer")(55,"button",21),p("click",function(){return e.closeModal()}),o(56,"Close"),i(),n(57,"button",22),p("click",function(){return e.isEditMode?e.updateCountry():e.saveCountry()}),o(58),i()()()),s&2&&(a(9),g("ngModel",e.searchText),a(15),h("ngForOf",x(26,15,x(25,12,e.conList,e.searchText),D(18,ce,e.p))),a(4),h("visible",e.isModalVisible),a(3),C(e.isEditMode?"Edit Class":"Add Class"),a(7),g("ngModel",e.currentCountry.name),a(4),g("ngModel",e.currentCountry.classLevel),a(),h("ngForOf",e.classLevels),a(4),g("ngModel",e.currentCountry.classTeacher),a(),h("ngForOf",e.classTeachers),a(4),g("ngModel",e.currentCountry.classAssistTeacher),a(),h("ngForOf",e.classTeachers),a(5),C(e.isEditMode?"Update":"Save"))},dependencies:[P,W,I,O,V,ie,Q,Z,ee,j,X,K,Y,te,ne,J,z,$,A,se,oe,re,N,U,G,H,R,q,F]});let l=m;return l})();export{Ie as ClassesComponent};
