import{a as te,b as ie,c as ne}from"./chunk-5GULS5GK.js";import{a as re}from"./chunk-KEQMXZG3.js";import"./chunk-GOXB5OSV.js";import{a as $}from"./chunk-4BHWRWDA.js";import{a as N}from"./chunk-ZP7S6SWW.js";import{b as H,c as K,d as Y,g as z,j as J,k as Q,t as X,v as Z,w as ee}from"./chunk-EAGDHIOY.js";import{aa as V,ba as F,bb as O,cb as P,d as L,qb as W,ra as I,sa as A,sb as G,tb as U,ub as j,va as R,vb as q}from"./chunk-ZE63MCPL.js";import{Kb as i,Lb as o,Qb as B,Vb as a,Xb as _,db as d,eb as E,hc as r,ia as T,ic as C,mc as y,nc as b,oc as S,qc as D,sc as k,ta as f,tc as x,ua as g,vc as M,xb as w,zb as v}from"./chunk-DRLFSV2D.js";import{a as h,f as oe}from"./chunk-TMEVGU2Q.js";var l=oe(re());var le=u=>({itemsPerPage:4,currentPage:u});function se(u,m){if(u&1){let p=B();i(0,"tr")(1,"th",18),r(2),o(),i(3,"td"),r(4),o(),i(5,"td")(6,"button",19),a("click",function(){let n=f(p).$implicit,e=_();return g(e.viewCountry(n))}),i(7,"i",20),r(8,"view"),o()(),i(9,"button",21),a("click",function(){let n=f(p).$implicit,e=_();return g(e.editCountry(n))}),i(10,"i",22),r(11,"edit"),o()(),i(12,"button",23),a("click",function(){let n=f(p).$implicit,e=_();return g(e.deleteCountry(n))}),i(13,"i",24),r(14,"delete"),o()()()()}if(u&2){let p=m.$implicit,t=m.index;d(2),C(t+1),d(2),C(p.name)}}var ke=(()=>{let m=class m{constructor(t){this.apiService=t,this.conList=[],this.searchText="",this.p=1,this.isModalVisible=!1,this.isEditMode=!1,this.currentCountry={name:""}}refreshData(){this.apiService.get("ClassLevel/GetAll").subscribe({next:t=>{console.log("I reach here"),t.status==="success"?this.conList=t.data:l.default.fire({title:"Error",text:`${t.message}`,icon:"error",confirmButtonText:"Retry"})},error:t=>{l.default.fire({title:"Error",text:`${t.error.message}`,icon:"error",confirmButtonText:"Retry"})}})}ngOnInit(){this.refreshData()}saveCountry(){console.log("Save country:",this.currentCountry),this.isEditMode=!1,this.apiService.post("ClassLevel/Add",this.currentCountry).subscribe({next:t=>{console.log("Class Level added successful",t),t.status==="success"?l.default.fire({title:"Success!",text:`${t.message}`,icon:"success",confirmButtonText:"OK"}).then(()=>{this.closeModal(),this.ngOnInit()}):l.default.fire({title:"Error",text:`${t.message}`,icon:"error",confirmButtonText:"Retry"})},error:t=>{l.default.fire({title:"Error",text:`${t.error.message}`,icon:"error",confirmButtonText:"Retry"})}})}updateCountry(){let t={name:this.currentCountry.name};this.apiService.put(`ClassLevel/UpdateById/${this.currentCountry._id}`,t).subscribe({next:n=>{if(n.status==="success"){let e=this.conList.findIndex(c=>c.id===this.currentCountry._id);e!==-1&&(this.conList[e]=h({},this.currentCountry)),l.default.fire({title:"Updated!",text:`${n.message}`,icon:"success",confirmButtonText:"OK"}).then(()=>{this.closeModal(),this.ngOnInit()})}else l.default.fire({title:"Error",text:`${n.message}`,icon:"error",confirmButtonText:"Retry"})},error:n=>{l.default.fire({title:"Error",text:`${n.error.message||"An unexpected error occurred"}`,icon:"error",confirmButtonText:"Retry"})}})}viewCountry(t){let e=new Date(t.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"});l.default.fire({title:"Country Details",html:`<strong>Country:</strong> ${t.name}
      <br/>
             <strong>CreatedAt:</strong> ${e} `,icon:"info",confirmButtonText:"Close"})}editCountry(t){console.log("Edit country:",t),this.currentCountry=h({},t),this.isEditMode=!0,this.openModal()}deleteCountry(t){l.default.fire({title:"Are you sure?",text:`Do you want to delete ${t.name}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then(n=>{n.isConfirmed?this.apiService.delete(`ClassLevel/DeleteById/${t.id}`).subscribe({next:()=>{this.conList=this.conList.filter(e=>e.id!==t.id),l.default.fire("Deleted!",`${t.name} has been deleted.`,"success"),this.ngOnInit()},error:e=>{l.default.fire({title:"Error",text:`${e.error.message}`,icon:"error",confirmButtonText:"Retry"})}}):n.dismiss===l.default.DismissReason.cancel&&l.default.fire("Cancelled",`${t.name} is safe.`,"error")})}openModal(){console.log("Opening modal"),this.isModalVisible=!0}closeModal(){this.isModalVisible=!1}};m.\u0275fac=function(n){return new(n||m)(E(N))},m.\u0275cmp=T({type:m,selectors:[["app-classlevel"]],standalone:!0,features:[D],decls:40,vars:14,consts:[["xs","12"],[1,"mb-4"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","btn-primary","ml-auto",3,"click"],["type","text","placeholder","Search class level",1,"form-control","mb-3",3,"ngModelChange","ngModel"],["cTable","",1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],[3,"pageChange"],["backdrop","static",3,"visibleChange","visible"],["cModalTitle",""],["cButtonClose","",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","countryName"],["type","text","id","countryName","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["cButton","","color","secondary",3,"click"],["cButton","","color","primary",3,"click"],["scope","row"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-eyes"],[1,"btn","btn-sm","btn-warning",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fa","fa-times"]],template:function(n,e){n&1&&(i(0,"c-row")(1,"c-col",0)(2,"c-card",1)(3,"c-card-header",2)(4,"strong"),r(5,"Class Level List"),o(),i(6,"button",3),a("click",function(){return e.openModal()}),r(7,"Add"),o()(),i(8,"c-card-body")(9,"input",4),S("ngModelChange",function(s){return b(e.searchText,s)||(e.searchText=s),s}),o(),i(10,"table",5)(11,"thead")(12,"tr")(13,"th",6),r(14,"SN"),o(),i(15,"th",6),r(16,"Class Level Name"),o(),i(17,"th",6),r(18,"Actions"),o()()(),i(19,"tbody"),w(20,se,15,2,"tr",7),x(21,"search"),x(22,"paginate"),o()(),i(23,"pagination-controls",8),a("pageChange",function(s){return e.p=s}),o()()()()(),i(24,"c-modal",9),a("visibleChange",function(s){return e.isModalVisible=s}),i(25,"c-modal-header")(26,"h5",10),r(27),o(),i(28,"button",11),a("click",function(){return e.closeModal()}),o()(),i(29,"c-modal-body")(30,"form",12),a("ngSubmit",function(){return e.isEditMode?e.updateCountry():e.saveCountry()}),i(31,"div",13)(32,"label",14),r(33,"Class Level Name"),o(),i(34,"input",15),S("ngModelChange",function(s){return b(e.currentCountry.name,s)||(e.currentCountry.name=s),s}),o()()()(),i(35,"c-modal-footer")(36,"button",16),a("click",function(){return e.closeModal()}),r(37,"Close"),o(),i(38,"button",17),a("click",function(){return e.isEditMode?e.updateCountry():e.saveCountry()}),r(39),o()()()),n&2&&(d(9),y("ngModel",e.searchText),d(11),v("ngForOf",M(22,9,M(21,6,e.conList,e.searchText),k(12,le,e.p))),d(4),v("visible",e.isModalVisible),d(3),C(e.isEditMode?"Edit Class Level":"Add Class Level"),d(7),y("ngModel",e.currentCountry.name),d(5),C(e.isEditMode?"Update":"Save"))},dependencies:[P,O,I,R,A,ee,Q,H,K,Y,X,Z,J,z,V,L,ne,ie,te,$,q,U,j,W,G,F]});let u=m;return u})();export{ke as ClasseslevelComponent};
