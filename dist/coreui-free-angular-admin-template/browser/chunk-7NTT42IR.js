import{a as re,b as le,c as ae}from"./chunk-5GULS5GK.js";import{a as ce}from"./chunk-KEQMXZG3.js";import"./chunk-GOXB5OSV.js";import{a as L}from"./chunk-4BHWRWDA.js";import{a as N}from"./chunk-ZP7S6SWW.js";import{b as j,c as H,d as Y,g as z,j as J,k as Q,l as X,q as Z,r as ee,s as te,t as ne,v as ie,w as oe}from"./chunk-EAGDHIOY.js";import{aa as k,ba as P,bb as K,cb as O,d as D,qb as R,ra as A,sa as V,sb as q,tb as G,ub as U,va as I,vb as $}from"./chunk-ZE63MCPL.js";import{Kb as n,Lb as o,Qb as F,Vb as u,Xb as S,db as s,eb as v,hc as r,ia as E,ic as C,mc as d,nc as m,oc as p,qc as B,sc as W,ta as b,tc as T,ua as f,vc as w,xb as x,zb as M}from"./chunk-DRLFSV2D.js";import{a as _,f as se}from"./chunk-TMEVGU2Q.js";var c=se(ce());var ue=h=>({itemsPerPage:4,currentPage:h});function de(h,y){if(h&1){let g=F();n(0,"tr")(1,"th",40),r(2),o(),n(3,"td"),r(4),o(),n(5,"td"),r(6),o(),n(7,"td"),r(8),o(),n(9,"td")(10,"button",41),u("click",function(){let l=b(g).$implicit,e=S();return f(e.viewCountry(l))}),n(11,"i",42),r(12,"view"),o()(),n(13,"button",43),u("click",function(){let l=b(g).$implicit,e=S();return f(e.editCountry(l))}),n(14,"i",44),r(15,"edit"),o()(),n(16,"button",45),u("click",function(){let l=b(g).$implicit,e=S();return f(e.deleteCountry(l))}),n(17,"i",46),r(18,"delete"),o()()()()}if(h&2){let g=y.$implicit,t=y.index;s(2),C(t+1),s(2),C(g.name),s(2),C(g.address),s(2),C(g.website)}}var ke=(()=>{let y=class y{constructor(t){this.apiService=t,this.conList=[],this.searchText="",this.p=1,this.isModalVisible=!1,this.isEditMode=!1,this.currentCountry={name:"",address:"",displayPicture:"",themeColour:"",subscriptionType:"",subscriptionTypeFee:0,website:"",email:"",mobileNumber:"",pinKey:""},this.selectedLogoFile=null}refreshData(){this.apiService.get("School/GetAll").subscribe({next:t=>{t.status==="success"?this.conList=t.data:c.default.fire({title:"Error",text:`${t.message}`,icon:"error",confirmButtonText:"Retry"})},error:t=>{c.default.fire({title:"Error",text:`${t.error.message}`,icon:"error",confirmButtonText:"Retry"})}})}ngOnInit(){this.refreshData()}onSubmit(){let t=new FormData;t.append("name",this.currentCountry.name),t.append("address",this.currentCountry.address),this.selectedLogoFile&&t.append("logo",this.selectedLogoFile),t.append("themeColour",this.currentCountry.themeColour),t.append("subscriptionType",this.currentCountry.subscriptionType),t.append("subscriptionTypeFee",this.currentCountry.subscriptionTypeFee),t.append("website",this.currentCountry.website),t.append("email",this.currentCountry.email),t.append("mobileNumber",this.currentCountry.mobileNumber),t.append("pinKey",this.currentCountry.pinKey),console.log("Form submission successful",t),this.apiService.post("School/Add",t).subscribe({next:l=>{console.log("Form submission successful",l),l.status==="success"?c.default.fire({title:"Success!",text:`${l.message}`,icon:"success",confirmButtonText:"OK"}).then(()=>{this.closeModal(),this.ngOnInit()}):c.default.fire({title:"Error",text:`${l.message}`,icon:"error",confirmButtonText:"Retry"})},error:l=>{c.default.fire({title:"Error",text:`${l.error.message}`,icon:"error",confirmButtonText:"Retry"})}})}saveCountry(){console.log("Save country:",this.currentCountry),this.isEditMode=!1,this.apiService.post("School/Add",this.currentCountry).subscribe({next:t=>{console.log("School added successful",t),t.status==="success"?c.default.fire({title:"Success!",text:`${t.message}`,icon:"success",confirmButtonText:"OK"}).then(()=>{this.closeModal(),this.ngOnInit()}):c.default.fire({title:"Error",text:`${t.message}`,icon:"error",confirmButtonText:"Retry"})},error:t=>{c.default.fire({title:"Error",text:`${t.error.message}`,icon:"error",confirmButtonText:"Retry"})}})}updateCountry(){let t=new FormData;t.append("name",this.currentCountry.name),t.append("address",this.currentCountry.address),this.selectedLogoFile&&t.append("logo",this.selectedLogoFile),t.append("themeColour",this.currentCountry.themeColour),t.append("subscriptionType",this.currentCountry.subscriptionType),t.append("subscriptionTypeFee",this.currentCountry.subscriptionTypeFee),t.append("website",this.currentCountry.website),t.append("email",this.currentCountry.email),t.append("mobileNumber",this.currentCountry.mobileNumber),t.append("pinKey",this.currentCountry.pinKey),console.log("Form submission successful",t),this.apiService.put(`School/UpdateById/${this.currentCountry.id}`,t).subscribe({next:l=>{if(l.status==="success"){let e=this.conList.findIndex(a=>a.id===this.currentCountry.id);e!==-1&&(this.conList[e]=_({},this.currentCountry)),c.default.fire({title:"Updated!",text:`${l.message}`,icon:"success",confirmButtonText:"OK"}).then(()=>{this.closeModal(),this.ngOnInit()})}else c.default.fire({title:"Error",text:`${l.message}`,icon:"error",confirmButtonText:"Retry"})},error:l=>{c.default.fire({title:"Error",text:`${l.error.message||"An unexpected error occurred"}`,icon:"error",confirmButtonText:"Retry"})}})}viewCountry(t){let e=new Date(t.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"});c.default.fire({title:"School Details",html:`<strong>School:</strong> ${t.name}
      <br/>
             <strong>CreatedAt:</strong> ${e} `,icon:"info",confirmButtonText:"Close"})}editCountry(t){console.log("Edit country:",t),this.currentCountry=_({},t),this.isEditMode=!0,this.openModal()}deleteCountry(t){c.default.fire({title:"Are you sure?",text:`Do you want to delete ${t.name}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then(l=>{l.isConfirmed?this.apiService.delete(`School/DeleteById/${t.id}`).subscribe({next:()=>{this.conList=this.conList.filter(e=>e.id!==t.id),c.default.fire("Deleted!",`${t.name} has been deleted.`,"success"),this.ngOnInit()},error:e=>{c.default.fire({title:"Error",text:`${e.error.message}`,icon:"error",confirmButtonText:"Retry"})}}):l.dismiss===c.default.DismissReason.cancel&&c.default.fire("Cancelled",`${t.name} is safe.`,"error")})}onFileChange(t){this.selectedLogoFile=t.target.files[0]}openModal(){console.log("Opening modal"),this.isModalVisible=!0}closeModal(){this.isModalVisible=!1}};y.\u0275fac=function(l){return new(l||y)(v(N))},y.\u0275cmp=E({type:y,selectors:[["app-school"]],standalone:!0,features:[B],decls:91,vars:22,consts:[["xs","12"],[1,"mb-4"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","btn-primary","ml-auto",3,"click"],["type","text","placeholder","Search schools",1,"form-control","mb-3",3,"ngModelChange","ngModel"],["cTable","",1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],[3,"pageChange"],["backdrop","static",3,"visibleChange","visible"],["cModalTitle",""],["cButtonClose","",3,"click"],[3,"ngSubmit"],[1,"container"],[1,"row"],[1,"form-group","col-md-6"],["for","countryName"],["type","text","id","countryName","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","countryAddress"],["type","text","id","countryAddress","name","address","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","countryLogo"],["type","file","id","countryLogo","required","",1,"form-control",3,"change"],["for","countryThemeColour"],["type","color","id","countryThemeColour","name","themeColour","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","countrySubscriptionType"],["id","countrySubscriptionType","name","subscriptionType","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","Student"],["value","School"],["for","countrySubscriptionTypeFee"],["type","number","id","countrySubscriptionTypeFee","name","subscriptionTypeFee","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","countryWebsite"],["type","text","id","countryWebsite","name","website","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","countryEmail"],["type","text","id","countryEmail","name","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","countryMobileNumber"],["type","text","id","countryMobileNumber","name","mobileNumber","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","countryPinKey"],["type","text","id","countryPinKey","name","pinKey","required","",1,"form-control",3,"ngModelChange","ngModel"],["cButton","","color","secondary",3,"click"],["cButton","","color","primary",3,"click"],["scope","row"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-eyes"],[1,"btn","btn-sm","btn-warning",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fa","fa-times"]],template:function(l,e){l&1&&(n(0,"c-row")(1,"c-col",0)(2,"c-card",1)(3,"c-card-header",2)(4,"strong"),r(5,"Schools List"),o(),n(6,"button",3),u("click",function(){return e.openModal()}),r(7,"Add"),o()(),n(8,"c-card-body")(9,"input",4),p("ngModelChange",function(i){return m(e.searchText,i)||(e.searchText=i),i}),o(),n(10,"table",5)(11,"thead")(12,"tr")(13,"th",6),r(14,"SN"),o(),n(15,"th",6),r(16,"Name"),o(),n(17,"th",6),r(18,"Address"),o(),n(19,"th",6),r(20,"Website"),o(),n(21,"th",6),r(22,"Actions"),o()()(),n(23,"tbody"),x(24,de,19,4,"tr",7),T(25,"search"),T(26,"paginate"),o()(),n(27,"pagination-controls",8),u("pageChange",function(i){return e.p=i}),o()()()()(),n(28,"c-modal",9),u("visibleChange",function(i){return e.isModalVisible=i}),n(29,"c-modal-header")(30,"h5",10),r(31),o(),n(32,"button",11),u("click",function(){return e.closeModal()}),o()(),n(33,"c-modal-body")(34,"form",12),u("ngSubmit",function(){return e.isEditMode?e.updateCountry():e.saveCountry()}),n(35,"div",13)(36,"form")(37,"div",14)(38,"div",15)(39,"label",16),r(40,"School Name"),o(),n(41,"input",17),p("ngModelChange",function(i){return m(e.currentCountry.name,i)||(e.currentCountry.name=i),i}),o()(),n(42,"div",15)(43,"label",18),r(44,"School Address"),o(),n(45,"input",19),p("ngModelChange",function(i){return m(e.currentCountry.address,i)||(e.currentCountry.address=i),i}),o()()(),n(46,"div",14)(47,"div",15)(48,"label",20),r(49,"School Logo"),o(),n(50,"input",21),u("change",function(i){return e.onFileChange(i)}),o()(),n(51,"div",15)(52,"label",22),r(53,"School Theme Colour"),o(),n(54,"input",23),p("ngModelChange",function(i){return m(e.currentCountry.themeColour,i)||(e.currentCountry.themeColour=i),i}),o()()(),n(55,"div",14)(56,"div",15)(57,"label",24),r(58,"School Subscription Type"),o(),n(59,"select",25),p("ngModelChange",function(i){return m(e.currentCountry.subscriptionType,i)||(e.currentCountry.subscriptionType=i),i}),n(60,"option",26),r(61,"Student"),o(),n(62,"option",27),r(63,"School"),o()()(),n(64,"div",15)(65,"label",28),r(66,"School Subscription Type Fee"),o(),n(67,"input",29),p("ngModelChange",function(i){return m(e.currentCountry.subscriptionTypeFee,i)||(e.currentCountry.subscriptionTypeFee=i),i}),o()()(),n(68,"div",14)(69,"div",15)(70,"label",30),r(71,"School Website"),o(),n(72,"input",31),p("ngModelChange",function(i){return m(e.currentCountry.website,i)||(e.currentCountry.website=i),i}),o()(),n(73,"div",15)(74,"label",32),r(75,"School Email"),o(),n(76,"input",33),p("ngModelChange",function(i){return m(e.currentCountry.email,i)||(e.currentCountry.email=i),i}),o()()(),n(77,"div",14)(78,"div",15)(79,"label",34),r(80,"Mobile Number"),o(),n(81,"input",35),p("ngModelChange",function(i){return m(e.currentCountry.mobileNumber,i)||(e.currentCountry.mobileNumber=i),i}),o()(),n(82,"div",15)(83,"label",36),r(84,"Pin Key"),o(),n(85,"input",37),p("ngModelChange",function(i){return m(e.currentCountry.pinKey,i)||(e.currentCountry.pinKey=i),i}),o()()()()()()(),n(86,"c-modal-footer")(87,"button",38),u("click",function(){return e.closeModal()}),r(88,"Close"),o(),n(89,"button",39),u("click",function(){return e.isEditMode?e.updateCountry():e.onSubmit()}),r(90),o()()()),l&2&&(s(9),d("ngModel",e.searchText),s(15),M("ngForOf",w(26,17,w(25,14,e.conList,e.searchText),W(20,ue,e.p))),s(4),M("visible",e.isModalVisible),s(3),C(e.isEditMode?"Edit School":"Add School"),s(10),d("ngModel",e.currentCountry.name),s(4),d("ngModel",e.currentCountry.address),s(9),d("ngModel",e.currentCountry.themeColour),s(5),d("ngModel",e.currentCountry.subscriptionType),s(8),d("ngModel",e.currentCountry.subscriptionTypeFee),s(5),d("ngModel",e.currentCountry.website),s(4),d("ngModel",e.currentCountry.email),s(5),d("ngModel",e.currentCountry.mobileNumber),s(4),d("ngModel",e.currentCountry.pinKey),s(5),C(e.isEditMode?"Update":"Save"))},dependencies:[O,K,A,I,V,oe,Q,ee,te,j,X,Z,H,Y,ne,ie,J,z,k,D,ae,le,re,L,$,G,U,R,q,P]});let h=y;return h})();export{ke as SchoolComponent};
